// This script analyzes query execution times

global start

probe begin
{
    printf("Probing binary %s\n", @1)
}

// Store start point
probe process(@1).provider("HYRISE").mark("QUERY_START")
{
    start[$arg3, user_string($arg1)] = gettimeofday_us()
}

// Query has finished
probe process(@1).provider("HYRISE").mark("QUERY_END")
{
    end = gettimeofday_us()
    printf("============================\n"
           "Query: %s\n"
           "Tasks spawned: %i\n"
           "Execution time: %iÎ¼s\n"
           "============================\n", user_string($arg1), $arg2, end - start[$arg3, user_string($arg1)]);
    delete start[$arg3, user_string($arg1)]
}
